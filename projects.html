<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Projects | UNEPP</title>
  <meta name="description" content="UNEPP project portfolio across offshore, onshore, pipelines, terminals, engineering studies, and project management services." />
  <link rel="stylesheet" href="css/style.css" />

  <!-- Page-local styling (move into css/style.css if you prefer) -->
  <style>
    html { scroll-behavior: smooth; }

    /* Filters (higher contrast) */
    .filters{
      display:grid;
      gap:14px;
      padding:18px;
      border:1px solid #d5dbe3;
      border-radius:14px;
      margin:16px 0 28px;
      background:#f7f9fc;
    }
    .filters-row{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      align-items:center;
    }
    .filters label{
      font-weight:700;
      color:#1f2a37;
    }
    .filters input[type="search"]{
      flex:1 1 260px;
      padding:10px 14px;
      border:1px solid #cbd5e1;
      border-radius:10px;
      background:#ffffff;
      color:#1f2a37;
      font-size:0.95rem;
    }
    .pill-group{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .pill{
      padding:8px 14px;
      border:1px solid #cbd5e1;
      border-radius:999px;
      background:#ffffff;
      cursor:pointer;
      font-size:0.9rem;
      font-weight:600;
      color:#1f2a37;
      transition:all 0.2s ease;
      user-select:none;
      white-space:nowrap;
    }
    .pill:hover{ background:#e2e8f0; }
    .pill[aria-pressed="true"]{
      background:#0f172a;
      color:#ffffff;
      border-color:#0f172a;
    }
    .filters .meta{
      font-size:0.95rem;
      color:#334155;
      font-weight:700;
    }
    .filters .actions{ margin-left:auto; }
    .filters .btn{
      padding:8px 14px;
      border:1px solid #cbd5e1;
      border-radius:10px;
      background:#ffffff;
      font-weight:700;
      cursor:pointer;
      color:#1f2937;
      transition:all 0.2s ease;
      white-space:nowrap;
    }
    .filters .btn:hover{ background:#e2e8f0; }

    /* Client dropdown/panel */
    .clients-panel{
      border:1px solid #d5dbe3;
      background:#ffffff;
      border-radius:14px;
      padding:14px;
      margin-top:-6px;
    }
    .clients-panel-inner{ display:grid; gap:10px; }
    .clients-label{ font-weight:700; color:#1f2a37; }
    .clients-list{
      display:grid;
      gap:8px;
      max-height:240px;
      overflow:auto;
      padding:8px;
      border:1px solid #e2e8f0;
      border-radius:12px;
      background:#f8fafc;
    }
    .client-item{
      display:flex;
      align-items:center;
      gap:10px;
      padding:8px 10px;
      border-radius:10px;
      background:#ffffff;
      border:1px solid #e5e7eb;
    }
    .client-item input{ transform: translateY(1px); }
    .client-item span{ color:#0f172a; font-weight:700; }

    /* Project cards */
    .projects-grid{
      display:grid;
      gap:16px;
      margin:12px 0 28px;
    }
    .project-card{
      border:1px solid #d5dbe3;
      border-radius:16px;
      padding:18px;
      background:#ffffff;
      box-shadow:0 4px 12px rgba(0,0,0,0.05);
      transition:all 0.2s ease;
    }
    .project-card:hover{
      box-shadow:0 6px 18px rgba(0,0,0,0.08);
      transform:translateY(-2px);
    }
    .project-card h4{
      margin:0 0 10px;
      font-size:1.05rem;
      color:#0f172a;
    }
    .project-card h4 a{
      color:#0f172a;
      text-decoration:none;
    }
    .project-card h4 a:hover{ text-decoration:underline; }
    .tags{ display:flex; flex-wrap:wrap; gap:6px; }
    .tag{
      font-size:0.8rem;
      padding:5px 10px;
      border-radius:999px;
      background:#e2e8f0;
      color:#1e293b;
      font-weight:700;
      white-space:nowrap;
    }
    .project-note{
      margin-top:10px;
      color:#475569;
      font-weight:600;
    }
    .hidden{ display:none !important; }
  </style>
</head>

<body>

<div id="top"></div>

<header class="nav">
  <div class="container nav-inner">
    <a class="brand" href="index.html">
      <img src="assets/logo.png" alt="UNEPP logo" class="logo" />
      <div>
        <h1>UNEPP</h1>
        <small>United Engineers for Petroleum Projects</small>
      </div>
    </a>

    <nav class="menu">
      <a href="index.html">Home</a>
      <a href="about.html">About Us</a>
      <a href="capabilities.html">Capabilities</a>
      <a href="projects.html">Projects</a>
      <a href="news.html">News</a>
      <a href="careers.html">Career</a>
      <a class="cta" href="contact.html">Contact Us</a>
    </nav>
  </div>
</header>

<main class="container about-layout">

  <!-- Left Index -->
  <aside class="about-index">
    <b>Projects</b>
    <nav>
      <a href="#top">Overview</a>
      <a href="#offshore-projects">Offshore Projects</a>
      <a href="#onshore-projects">Onshore & Facilities</a>
      <a href="#pipelines">Pipeline Projects</a>
      <a href="#terminals">Terminals & Marine</a>
      <a href="#project-management">Project Management</a>
      <a href="#studies">Engineering Studies</a>
    </nav>
  </aside>

  <!-- Page Content -->
  <div class="about-content">

    <!-- Overview + Filters -->
    <section id="overview">
      <div class="section-intro">
        <h2>Selected Project Experience</h2>
        <p class="lead">
          A selection of UNEPP experience across Egypt, the wider MENA region, and international assignments.
          Use the filters below to explore by region, type, client, and service.
        </p>
      </div>

      <div class="filters" id="projectFilters">
        <div class="filters-row">
          <label for="projectSearch">Search</label>
          <input id="projectSearch" type="search" placeholder="Search projects (name, client, service…)" autocomplete="off" />
          <div class="actions">
            <button class="btn" type="button" id="clearFilters">Clear</button>
          </div>
        </div>

        <div class="filters-row">
          <span class="meta">Region</span>
          <div class="pill-group">
            <button class="pill" type="button" data-filter="region" data-value="Egypt" aria-pressed="false">Egypt</button>
            <button class="pill" type="button" data-filter="region" data-value="Other MENA" aria-pressed="false">Other MENA</button>
            <button class="pill" type="button" data-filter="region" data-value="International" aria-pressed="false">International</button>
          </div>
        </div>

        <div class="filters-row">
          <span class="meta">Type</span>
          <div class="pill-group">
            <button class="pill" type="button" data-filter="type" data-value="Offshore" aria-pressed="false">Offshore</button>
            <button class="pill" type="button" data-filter="type" data-value="Onshore" aria-pressed="false">Onshore</button>
          </div>
        </div>

        <div class="filters-row">
          <span class="meta">Service</span>
          <div class="pill-group">
            <button class="pill" type="button" data-filter="service" data-value="Feasibility & Concept Selection" aria-pressed="false">
              Feasibility & Concept Selection
            </button>
            <button class="pill" type="button" data-filter="service" data-value="FEED" aria-pressed="false">FEED</button>
            <button class="pill" type="button" data-filter="service" data-value="Detailed Design" aria-pressed="false">Detailed Design</button>
            <button class="pill" type="button" data-filter="service" data-value="Project Management" aria-pressed="false">Project Management</button>
            <button class="pill" type="button" data-filter="service" data-value="Procurement Services" aria-pressed="false">Procurement Services</button>
            <button class="pill" type="button" data-filter="service" data-value="Offshore Engineering" aria-pressed="false">Offshore Engineering</button>
          </div>
        </div>

        <!-- Clients: single button + searchable list -->
        <div class="filters-row">
          <span class="meta">Client</span>
          <button class="btn" type="button" id="toggleClients" aria-expanded="false" aria-controls="clientsPanel">
            Clients <span id="clientCount">(0)</span>
          </button>
        </div>

        <div id="clientsPanel" class="clients-panel hidden" role="region" aria-label="Client filters">
          <div class="clients-panel-inner">
            <label for="clientSearch" class="clients-label">Find a client</label>
            <input id="clientSearch" type="search" placeholder="Type to search clients…" autocomplete="off" />
            <div id="clientsList" class="clients-list">
              <!-- auto-populated from project cards -->
            </div>
          </div>
        </div>

        <div class="filters-row">
          <span class="meta">Showing <b id="shownCount">0</b> of <b id="totalCount">0</b></span>
        </div>
      </div>
    </section>

    <!-- Offshore Projects -->
    <section id="offshore-projects">
      <h3>Offshore Projects</h3>

      <div class="projects-grid">
        <!-- UPDATED FROM ATTACHED TABLES -->
        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="PMS"
          data-service="Offshore Engineering">
          <h4><a href="#">Offshore Power Generation and Platform Modifications Zaafarana-Structural</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">PMS</span><span class="tag">Offshore Engineering</span>
          </div>
          <p class="project-note">Red Sea • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="PPIS"
          data-service="Offshore Engineering">
          <h4><a href="#">Offshore Power Generation and Platform Modifications Zaafarana-Topside</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">PPIS</span><span class="tag">Offshore Engineering</span>
          </div>
          <p class="project-note">Red Sea • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="GEMSA"
          data-service="Offshore Engineering">
          <h4><a href="#">Structural Analysis WARDA Platform</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">GEMSA</span><span class="tag">Offshore Engineering</span>
          </div>
          <p class="project-note">Cairo • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="PMS"
          data-service="Offshore Engineering">
          <h4><a href="#">PetroGulf Additional 4 new wells and Tie-in Facilities at New GNN Field</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">PMS</span><span class="tag">Offshore Engineering</span>
          </div>
          <p class="project-note">Red Sea • 2024</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="PMS"
          data-service="Offshore Engineering">
          <h4><a href="#">Petrobel Structural Detailed Design for New Lean Structure</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">PMS</span><span class="tag">Offshore Engineering</span>
          </div>
          <p class="project-note">Red Sea • 2023</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="PMS"
          data-service="Offshore Engineering">
          <h4><a href="#">Petrobel Structural Detailed Design for MWP6 Spider Tripod at Mela’ha Field</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">PMS</span><span class="tag">Offshore Engineering</span>
          </div>
          <p class="project-note">Red Sea • 2023</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="PMS"
          data-service="Offshore Engineering">
          <h4><a href="#">Petrobel Structural Detailed Design for MWP5 Tripod at Mela’ha Field</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">PMS</span><span class="tag">Offshore Engineering</span>
          </div>
          <p class="project-note">Red Sea • 2023</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="PMS"
          data-service="Offshore Engineering">
          <h4><a href="#">Structural Design for Trapezoid Platform Deck MWP4 in Mela’ha Field</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">PMS</span><span class="tag">Offshore Engineering</span>
          </div>
          <p class="project-note">Red Sea • 2023</p>
        </article>
      </div>
    </section>

    <!-- Onshore & Facilities -->
    <section id="onshore-projects">
      <h3>Onshore & Facilities</h3>

      <div class="projects-grid">
        <!-- UPDATED FROM ATTACHED TABLES (Engineering) -->
        <article class="project-card project"
          data-region="Other MENA"
          data-type="Onshore"
          data-client="MCS"
          data-service="FEED">
          <h4><a href="#">FEED for Additional DAS Produced Water Disposal Facility</a></h4>
          <div class="tags">
            <span class="tag">Other MENA</span><span class="tag">Onshore</span>
            <span class="tag">MCS</span><span class="tag">FEED</span>
          </div>
          <p class="project-note">UAE • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Onshore"
          data-client="PhPC"
          data-service="Detailed Design">
          <h4><a href="#">New Control Room Engineering Disciplines Support</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Onshore</span>
            <span class="tag">PhPC</span><span class="tag">Detailed Design</span>
          </div>
          <p class="project-note">Portsaid • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Onshore"
          data-client="NORPETCO/BGC"
          data-service="Detailed Design">
          <h4><a href="#">Abrar Station Rehab</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Onshore</span>
            <span class="tag">NORPETCO/BGC</span><span class="tag">Detailed Design</span>
          </div>
          <p class="project-note">Red Sea • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Other MENA"
          data-type="Onshore"
          data-client="EMC"
          data-service="Procurement Services">
          <h4><a href="#">Engineering, Procurement &amp; Construction of New Crude Oil Tanks</a></h4>
          <div class="tags">
            <span class="tag">Other MENA</span><span class="tag">Onshore</span>
            <span class="tag">EMC</span><span class="tag">Procurement Services</span>
          </div>
          <p class="project-note">Iraq • 2023</p>
        </article>

        <!-- Add more onshore items here as needed (the client dropdown and filters will still work) -->
      </div>
    </section>

    <!-- Pipeline Projects -->
    <section id="pipelines">
      <h3>Pipeline Projects</h3>

      <div class="projects-grid">
        <!-- UPDATED FROM ATTACHED TABLES -->
        <article class="project-card project"
          data-region="Egypt"
          data-type="Onshore"
          data-client="INDORAMA/EGAS"
          data-service="FEED">
          <h4><a href="#">Ammonia Pipeline for Indorama Egypt Fertilizers</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Onshore</span>
            <span class="tag">INDORAMA/EGAS</span><span class="tag">FEED</span>
          </div>
          <p class="project-note">Ain Soukna • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Onshore"
          data-client="AGIBA/Petromaint"
          data-service="Feasibility &amp; Concept Selection">
          <h4><a href="#">MELIEHA EL Hamra Crude oil 16 “ Pipeline for AGIBA (HAZOP)</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Onshore</span>
            <span class="tag">AGIBA/Petromaint</span><span class="tag">Feasibility &amp; Concept Selection</span>
          </div>
          <p class="project-note">Cairo • 2023</p>
        </article>

        <article class="project-card project"
          data-region="Other MENA"
          data-type="Onshore"
          data-client="EGAS"
          data-service="Project Management">
          <h4><a href="#">ASAB Gas Injection Trunk Line-2 Relocation Project</a></h4>
          <div class="tags">
            <span class="tag">Other MENA</span><span class="tag">Onshore</span>
            <span class="tag">EGAS</span><span class="tag">Project Management</span>
          </div>
          <p class="project-note">Abu Dhabi • 2023</p>
        </article>
      </div>
    </section>

    <!-- Terminals & Marine -->
    <section id="terminals">
      <h3>Terminals &amp; Marine Infrastructure</h3>

      <div class="projects-grid">
        <!-- UPDATED FROM ATTACHED TABLES -->
        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="UGDC"
          data-service="Feasibility &amp; Concept Selection">
          <h4><a href="#">InstallingSPM to replace current Damietta Jetty during FSRU Operation</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">UGDC</span><span class="tag">Feasibility &amp; Concept Selection</span>
          </div>
          <p class="project-note">Damietta • 2025</p>
        </article>
      </div>
    </section>

    <!-- Project Management -->
    <section id="project-management">
      <h3>Project Management &amp; Construction Support</h3>

      <div class="projects-grid">
        <!-- UPDATED FROM ATTACHED TABLES -->
        <article class="project-card project"
          data-region="Egypt"
          data-type="Onshore"
          data-client="EgyptAnode/CTC"
          data-service="Project Management">
          <h4><a href="#">Project Management Team for Egypt Anode Coke Plant Refurbishment</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Onshore</span>
            <span class="tag">EgyptAnode/CTC</span><span class="tag">Project Management</span>
          </div>
          <p class="project-note">El Sokna • 2024</p>
        </article>

        <article class="project-card project"
          data-region="International"
          data-type="Onshore"
          data-client="METAS Energy"
          data-service="Project Management">
          <h4><a href="#">Initial Screening and High Level Review Data Evaluation</a></h4>
          <div class="tags">
            <span class="tag">International</span><span class="tag">Onshore</span>
            <span class="tag">METAS Energy</span><span class="tag">Project Management</span>
          </div>
          <p class="project-note">Niger • 2024</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Offshore"
          data-client="PetroWeb/PPIS"
          data-service="Project Management">
          <h4><a href="#">Review of Structural Engineering for WEB Offshore Development Project</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Offshore</span>
            <span class="tag">PetroWeb/PPIS</span><span class="tag">Project Management</span>
          </div>
          <p class="project-note">Cairo • 2023</p>
        </article>

        <!-- (Construction sheet entries are also tagged as Project Management to keep filtering consistent) -->
      </div>
    </section>

    <!-- Studies -->
    <section id="studies">
      <h3>Engineering Studies</h3>

      <div class="projects-grid">
        <!-- UPDATED FROM ATTACHED TABLES (Studies sheet) -->
        <article class="project-card project"
          data-region="Egypt"
          data-type="Onshore"
          data-client="PhPC"
          data-service="Feasibility &amp; Concept Selection">
          <h4><a href="#">New Flashed Gases Compressor Study</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Onshore</span>
            <span class="tag">PhPC</span><span class="tag">Feasibility &amp; Concept Selection</span>
          </div>
          <p class="project-note">Portsaid • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Onshore"
          data-client="PhPC"
          data-service="Feasibility &amp; Concept Selection">
          <h4><a href="#">West Harbour Gate Assessment and Repair Study</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Onshore</span>
            <span class="tag">PhPC</span><span class="tag">Feasibility &amp; Concept Selection</span>
          </div>
          <p class="project-note">Portsaid • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Onshore"
          data-client="PhPC"
          data-service="Feasibility &amp; Concept Selection">
          <h4><a href="#">New Heat Exchanger Upstream Atoll Water-Hydrocarbon Separator Study</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Onshore</span>
            <span class="tag">PhPC</span><span class="tag">Feasibility &amp; Concept Selection</span>
          </div>
          <p class="project-note">Portsaid • 2025</p>
        </article>

        <article class="project-card project"
          data-region="Egypt"
          data-type="Onshore"
          data-client="UGDC"
          data-service="Feasibility &amp; Concept Selection">
          <h4><a href="#">HVAC Openings in battery and UPS rooms</a></h4>
          <div class="tags">
            <span class="tag">Egypt</span><span class="tag">Onshore</span>
            <span class="tag">UGDC</span><span class="tag">Feasibility &amp; Concept Selection</span>
          </div>
          <p class="project-note">Portsaid • 2025</p>
        </article>

        <!-- Add the rest of the Studies entries the same way (copy/paste pattern) -->
      </div>
    </section>

  </div>
</main>

<script>
  (function () {
    const search = document.getElementById('projectSearch');
    const clearBtn = document.getElementById('clearFilters');

    const pills = Array.from(document.querySelectorAll('.pill[data-filter]'));
    const projects = Array.from(document.querySelectorAll('.project'));

    const shownCount = document.getElementById('shownCount');
    const totalCount = document.getElementById('totalCount');

    // Client panel elements
    const toggleClients = document.getElementById('toggleClients');
    const clientsPanel = document.getElementById('clientsPanel');
    const clientsList = document.getElementById('clientsList');
    const clientSearch = document.getElementById('clientSearch');
    const clientCount = document.getElementById('clientCount');

    // Multi-select filters
    const selected = {
      region: new Set(),
      type: new Set(),
      service: new Set(),
      client: new Set()
    };

    function normalize(s){ return (s || '').toLowerCase().trim(); }
    function matchesMulti(value, set){ return set.size === 0 || set.has(value); }

    function matchesSearch(project){
      const q = normalize(search.value);
      if (!q) return true;
      return normalize(project.textContent).includes(q);
    }

    function matchesPills(project){
      const region  = project.getAttribute('data-region')  || '';
      const type    = project.getAttribute('data-type')    || '';
      const client  = project.getAttribute('data-client')  || '';
      const service = project.getAttribute('data-service') || '';

      return (
        matchesMulti(region, selected.region) &&
        matchesMulti(type, selected.type) &&
        matchesMulti(service, selected.service) &&
        matchesMulti(client, selected.client)
      );
    }

    function applyFilters(){
      let shown = 0;
      projects.forEach(p => {
        const ok = matchesPills(p) && matchesSearch(p);
        p.classList.toggle('hidden', !ok);
        if (ok) shown++;
      });

      totalCount.textContent = String(projects.length);
      shownCount.textContent = String(shown);
      clientCount.textContent = `(${selected.client.size})`;
    }

    function togglePill(btn){
      const filter = btn.getAttribute('data-filter');
      const value = btn.getAttribute('data-value');
      const set = selected[filter];

      const isOn = set.has(value);
      if (isOn) set.delete(value);
      else set.add(value);

      btn.setAttribute('aria-pressed', String(!isOn));
      applyFilters();
    }

    // ---------- Client panel build ----------
    function uniqueClientsFromProjects(){
      const set = new Set();
      projects.forEach(p => {
        const c = (p.getAttribute('data-client') || '').trim();
        if (c) set.add(c);
      });
      return Array.from(set).sort((a,b)=>a.localeCompare(b));
    }

    function renderClientsList(){
      const q = normalize(clientSearch.value);
      const clients = uniqueClientsFromProjects().filter(c => normalize(c).includes(q));

      clientsList.innerHTML = clients.map(c => {
        const id = 'client_' + c.replace(/\W+/g,'_');
        const checked = selected.client.has(c) ? 'checked' : '';
        return `
          <label class="client-item" for="${id}">
            <input type="checkbox" id="${id}" data-client="${c}" ${checked} />
            <span>${c}</span>
          </label>
        `;
      }).join('');

      clientsList.querySelectorAll('input[type="checkbox"][data-client]').forEach(cb => {
        cb.addEventListener('change', (e) => {
          const val = e.target.getAttribute('data-client');
          if (e.target.checked) selected.client.add(val);
          else selected.client.delete(val);
          applyFilters();
        });
      });
    }

    function toggleClientsPanel(){
      const isHidden = clientsPanel.classList.contains('hidden');
      clientsPanel.classList.toggle('hidden', !isHidden);
      toggleClients.setAttribute('aria-expanded', String(isHidden));
      if (isHidden) {
        renderClientsList();
        clientSearch.focus();
      }
    }

    // ---------- Events ----------
    pills.forEach(btn => btn.addEventListener('click', () => togglePill(btn)));
    search.addEventListener('input', applyFilters);

    toggleClients.addEventListener('click', toggleClientsPanel);
    clientSearch.addEventListener('input', renderClientsList);

    document.addEventListener('click', (e) => {
      const within = clientsPanel.contains(e.target) || toggleClients.contains(e.target);
      if (!within) {
        clientsPanel.classList.add('hidden');
        toggleClients.setAttribute('aria-expanded', 'false');
      }
    });

    clearBtn.addEventListener('click', () => {
      search.value = '';
      Object.values(selected).forEach(s => s.clear());
      pills.forEach(btn => btn.setAttribute('aria-pressed', 'false'));
      clientSearch.value = '';
      renderClientsList();
      applyFilters();
    });

    // Init
    totalCount.textContent = String(projects.length);
    renderClientsList();
    applyFilters();
  })();
</script>

</body>
</html>
