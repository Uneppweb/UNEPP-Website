<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Projects | UNEPP</title>
  <meta name="description" content="UNEPP project portfolio across Egypt, MENA and international markets covering feasibility, FEED, detailed engineering, PMC and procurement." />
  <link rel="stylesheet" href="css/style.css" />

  <!-- Projects: one-section-at-a-time (page-local) -->
  <style>
    body[data-switcher="on"] main section[data-panel="1"][id]{ display:none; }
    body[data-switcher="on"] main section[data-panel="1"][id].is-active{ display:block; }
    body[data-switcher="on"] main{ min-height:60vh; }
  </style>
</head>

<body class="projects">

  <!-- Header -->
  <header class="nav">
    <div class="container nav-inner">
      <a class="brand" href="index.html">
        <img src="assets/logo.png" alt="UNEPP logo" class="logo" />
        <div>
          <h1>UNEPP</h1>
          <small>United Engineers for Petroleum Projects</small>
        </div>
      </a>

      <nav class="menu" aria-label="Primary">
        <a data-nav href="index.html">Home</a>
        <a data-nav href="about.html">About Us</a>
        <a data-nav href="capabilities.html">Capabilities</a>
        <a data-nav href="projects.html">Projects</a>
        <a data-nav href="news.html">News</a>
        <a data-nav href="careers.html">Career</a>
        <a data-nav class="cta" href="contact.html">Contact Us</a>
      </nav>
    </div>
  </header>

  <!-- Page layout (left index + content) -->
  <main class="container about-layout">

    <!-- Left index -->
    <aside class="about-index">
      <b>Projects</b>
      <nav>
        <a href="#projects-portfolio">Projects Portfolio</a>
        <a href="#projects-showcase">Projects Showcase</a>
      </nav>
    </aside>

    <!-- Page content -->
    <div class="about-content">

      <!-- Projects Portfolio -->
      <section class="section" id="projects-portfolio" data-panel="1">
        <div class="section-intro">
          <h2>Projects Portfolio</h2>

          <p class="lead">
            Our Projects Portfolio reflects UNEPP and UNIFIED’s multidisciplinary engineering expertise
            and regional project experience across Egypt, the wider MENA region, and selected
            international markets.
            <br><br>
            The portfolio demonstrates our capability to support clients at every stage of the
            project lifecycle. Each reference highlights our commitment to technical accuracy, schedule discipline,
            cost control, regulatory compliance, and adherence to international codes and standards.
            <br><br>
            Using the filters below, you can explore projects by client, region, service type,
            or year of execution to better understand the breadth and depth of our experience.
          </p>
        </div>

        <!-- Filters -->
        <div class="card projects-filters">
          <div class="filters-two-rows">

            <!-- Start state message inside filters -->
            <div id="startState" class="filter-start-message" style="margin-bottom:14px;">
              <p class="lead" style="margin:0;">
                <strong>Select a filter to view projects.</strong><br>
                To keep the page fast and easy to browse, projects are hidden until you apply at least one filter (or type a keyword).
              </p>
            </div>

            <div class="filters-row filters-row-search">
              <div class="filter-field filter-search">
                <label class="kicker" for="keyword">Search</label>
                <input
                  type="search"
                  id="keyword"
                  placeholder="Search by title, client, service, country..."
                  autocomplete="off"
                />
              </div>
            </div>

            <!-- Row 2: Company, Client, Region -->
            <div class="filters-row filters-row-selects filters-row-top">
              <div class="filter-field">
                <label class="kicker" for="company">Company</label>
                <select id="company">
                  <option value="">All</option>
                </select>
              </div>

              <div class="filter-field">
                <label class="kicker" for="client">Client</label>
                <select id="client">
                  <option value="">All</option>
                </select>
              </div>

              <div class="filter-field">
                <label class="kicker" for="region">Region</label>
                <select id="region">
                  <option value="">All</option>
                </select>
              </div>
            </div>

            <!-- Row 3: Service, Category, Year -->
            <div class="filters-row filters-row-selects filters-row-bottom">
              <div class="filter-field">
                <label class="kicker" for="service">Service</label>
                <select id="service">
                  <option value="">All</option>
                </select>
              </div>

              <div class="filter-field">
                <label class="kicker" for="category">Category</label>
                <select id="category">
                  <option value="">All</option>
                </select>
              </div>

              <div class="filter-field">
                <label class="kicker" for="year">Year</label>
                <select id="year">
                  <option value="">All</option>
                </select>
              </div>
            </div>

            <!-- Row 4: Reset -->
            <div class="filters-row filters-row-reset">
              <button id="reset" class="btn" type="button">➤ Reset</button>
            </div>

          </div>

          <hr class="line" />

          <div class="projects-meta">
            <div class="kicker">
              Showing <span id="count">0</span> projects
            </div>
          </div>
        </div>

        <!-- Cards appear here -->
        <div id="projectsGrid" class="projects-grid"></div>

        <!-- Empty state -->
        <div id="emptyState" class="card" style="display:none;">
          <h3 style="margin:0 0 8px;">No matches</h3>
          <p class="lead" style="margin:0;">Try clearing filters or selecting a different combination.</p>
        </div>

        <!-- Error state -->
        <div id="errorState" class="card" style="display:none;">
          <h3 style="margin:0 0 8px;">Couldn’t load projects</h3>
          <p class="lead" style="margin:0;">
            Please confirm <b>data/projects.json</b> exists and the path matches exactly (case-sensitive).
          </p>
        </div>
      </section>

      <!-- Projects Showcase -->
      <section class="section" id="projects-showcase" data-panel="1">
        <div class="section-intro">
          <h2>Projects Showcase</h2>
          <p class="lead">
            Explore selected UNEPP and UNIFIED references across feasibility, FEED,
            detailed engineering, procurement support, and project delivery.
          </p>
        </div>

        <!-- Project Summaries (PDF) -->
        <section class="section project-pdfs">
          <div class="section-intro">
            <h3>Selected Project Summaries</h3>
            <p class="lead">
              Download detailed PDF summaries for selected projects.
            </p>
          </div>

          <div class="pdf-list">
            <ul>
              <li><a href="assets/pdfs/Balsam-Compression-Relocation-and-Installation.pdf" target="_blank" rel="noopener">Balsam Compression Relocation and Installation</a></li>
              <li><a href="assets/pdfs/Crude-Oil-Plant-Development.pdf" target="_blank" rel="noopener">Crude Oil Plant Development</a></li>
              <li><a href="assets/pdfs/GNN-Early-Production-Facilities-Phase-I.pdf" target="_blank" rel="noopener">GNN Early Production Facilities (Phase I)</a></li>
              <li><a href="assets/pdfs/Indorama-Ammonia-Unloading-Pipeline.pdf" target="_blank" rel="noopener">Indorama Ammonia Unloading Pipeline</a></li>
              <li><a href="assets/pdfs/Main-Gate-Assessment-and-Repair-Study.pdf" target="_blank" rel="noopener">Main Gate Assessment and Repair Study</a></li>
              <li><a href="assets/pdfs/MWP-6-New-Lean-Structure.pdf" target="_blank" rel="noopener">MWP-6 New Lean Structure</a></li>
              <li><a href="assets/pdfs/New-West-Harbour-Flashed-Gas-Compressor.pdf" target="_blank" rel="noopener">New West Harbour Flashed Gas Compressor</a></li>
              <li><a href="assets/pdfs/UGDC-Terminal-Enhancement.pdf" target="_blank" rel="noopener">UGDC Terminal Enhancement</a></li>
              <li><a href="assets/pdfs/ZFDP-Phase-1-Pipelines-and-Structural-Scope.pdf" target="_blank" rel="noopener">ZFDP Phase 1 – Pipelines and Structural Scope</a></li>
              <li><a href="assets/pdfs/ZFDP-Phase-1-Topsides-Scope.pdf" target="_blank" rel="noopener">ZFDP Phase 1 – Topsides Scope</a></li>
            </ul>
          </div>
        </section>
      </section>

    </div><!-- /.about-content -->
  </main>

<!-- Footer -->
<footer class="footer">
  <div class="container" style="text-align:left;">

    <div>
      © <span id="y"></span> United Engineers for Petroleum Projects (UNEPP)   © <span id="y2"></span> Unified Engineering Consultancy LTD - L.L.C (UNIFIED)
    </div>

    <div style="margin-top:10px; font-size:13px; line-height:1.6; opacity:.85;">
      UNEPP and UNIFIED are independently registered legal entities under common ownership.
      Each company operates, contracts, and delivers services in accordance with the laws
      and regulations applicable in its respective jurisdiction.
    </div>

  </div>
</footer>

<script>
  const year = new Date().getFullYear();
  document.getElementById("y").textContent = year;
  document.getElementById("y2").textContent = year;
</script>

  <script>
    document.getElementById("y").textContent = new Date().getFullYear();

    const els = {
      keyword: document.getElementById("keyword"),
      company: document.getElementById("company"),
      client: document.getElementById("client"),
      region: document.getElementById("region"),
      service: document.getElementById("service"),
      category: document.getElementById("category"),
      year: document.getElementById("year"),
      reset: document.getElementById("reset"),
      grid: document.getElementById("projectsGrid"),
      count: document.getElementById("count"),
      start: document.getElementById("startState"),
      empty: document.getElementById("emptyState"),
      error: document.getElementById("errorState"),
    };

    let allProjects = [];

    function escapeHtml(str){
      return String(str ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function yearNum(y){
      const n = Number(String(y || "").trim());
      return Number.isFinite(n) ? n : 0;
    }

    function normCompany(v){
      const s = String(v || "").trim();
      if (!s) return "";
      const t = s.toLowerCase();
      if (t.includes("unified")) return "UNIFIED";
      if (t.includes("unepp")) return "UNEPP";
      return s;
    }

    function uniqSorted(arr){
      return [...new Set(arr
        .filter(v => v !== null && v !== undefined && String(v).trim() !== "")
        .map(v => String(v).trim())
      )].sort((a,b)=>a.localeCompare(b));
    }

    function fillSelect(select, values){
      select.innerHTML =
        '<option value="">All</option>' +
        values.map(v => `<option value="${escapeHtml(v)}">${escapeHtml(v)}</option>`).join("");
    }

    function render(projects){
      projects.sort((a,b)=> yearNum(b.Year) - yearNum(a.Year));

      els.count.textContent = String(projects.length);
      els.empty.style.display = projects.length ? "none" : "block";

      els.grid.innerHTML = projects.map(p => {
        const title = (p.Title || "").trim();
        const year = (p.Year || "").trim();
        const client = (p.Client || "").trim();
        const company = (p.Company || "").trim();
        const region = (p.Region || "").trim();
        const country = (p.Country || "").trim();
        const serviceMain = (p["Service-Main"] || "").trim();
        const service2 = (p["Service-2"] || "").trim();
        const category = (p.Category || "").trim();

        const showCountry =
          country &&
          (!region || country.toLowerCase() !== region.toLowerCase()) &&
          !(region.toLowerCase() === "egypt" && country.toLowerCase() === "egypt");

        const badges = [
          year ? `<span class="badge">${escapeHtml(year)}</span>` : "",
          client ? `<span class="badge">${escapeHtml(client)}</span>` : "",
          company ? `<span class="badge">${escapeHtml(company)}</span>` : "",
          region ? `<span class="badge">${escapeHtml(region)}</span>` : "",
          showCountry ? `<span class="badge">${escapeHtml(country)}</span>` : "",
          serviceMain ? `<span class="badge">${escapeHtml(serviceMain)}</span>` : "",
          service2 ? `<span class="badge">${escapeHtml(service2)}</span>` : "",
          category ? `<span class="badge">${escapeHtml(category)}</span>` : "",
        ].filter(Boolean).join("");

        return `
          <div class="card">
            <h3 class="project-title">${escapeHtml(title)}</h3>
            <div class="badges">${badges}</div>
          </div>
        `;
      }).join("");
    }

    function hasActiveFilters(){
      const keyword = (els.keyword.value || "").trim();
      return Boolean(
        keyword ||
        els.company.value ||
        els.client.value ||
        els.region.value ||
        els.service.value ||
        els.category.value ||
        els.year.value
      );
    }

    function showStartState(show){
      if (!els.start) return;
      els.start.style.display = show ? "block" : "none";
    }

    function clearResults(){
      els.grid.innerHTML = "";
      els.count.textContent = "0";
      els.empty.style.display = "none";
    }

    function applyFilters(){
      if (!hasActiveFilters()){
        showStartState(true);
        clearResults();
        return;
      }

      showStartState(false);

      const keyword = (els.keyword.value || "").toLowerCase().trim();
      const company = els.company.value;
      const client = els.client.value;
      const region = els.region.value;
      const service = els.service.value;
      const category = els.category.value;
      const year = els.year.value;

      const filtered = allProjects.filter(p => {
        if (company && (p.Company || "").trim() !== company) return false;
        if (client && (p.Client || "").trim() !== client) return false;
        if (region && (p.Region || "").trim() !== region) return false;
        if (service && (p["Service-Main"] || "").trim() !== service) return false;
        if (category && (p.Category || "").trim() !== category) return false;
        if (year && String((p.Year || "").trim()) !== String(year)) return false;

        if (keyword){
          const searchableText = [
            p.Title, p.Client, p.Company, p.Region, p.Country,
            p["Service-Main"], p["Service-2"], p.Category, p.Year
          ].join(" ").toLowerCase();

          if (!searchableText.includes(keyword)) return false;
        }

        return true;
      });

      render(filtered);
    }

    async function init(){
      try{
        if (!els.grid || !els.keyword || !els.company || !els.client || !els.region || !els.service || !els.category || !els.year) {
          throw new Error("Missing required HTML elements (check ids: projectsGrid, keyword, company, client, region, service, category, year).");
        }

        const res = await fetch("data/projects.json", { cache:"no-store" });
        if (!res.ok) throw new Error("Fetch failed: " + res.status);

        const data = await res.json();
        allProjects = Array.isArray(data) ? data : [];

        allProjects = allProjects.map(p => ({
          id: p.id ?? p.ID ?? "",
          Title: p.Title ?? p.title ?? "",
          Year: p.Year ?? p.year ?? "",
          Client: p.Client ?? p.client ?? "",
          Company: normCompany(p.Company ?? p.company ?? ""),
          Region: p.Region ?? p.region ?? "",
          Country: p.Country ?? p.country ?? "",
          "Service-Main": p["Service-Main"] ?? p.ServiceMain ?? p["Service Main"] ?? p.serviceMain ?? "",
          "Service-2": p["Service-2"] ?? p.Service2 ?? p["Service 2"] ?? p.service2 ?? "",
          Category: p.Category ?? p.category ?? "",
        }));

        fillSelect(els.company, uniqSorted(allProjects.map(p => p.Company)));
        fillSelect(els.client, uniqSorted(allProjects.map(p => p.Client)));
        fillSelect(els.region, uniqSorted(allProjects.map(p => p.Region)));
        fillSelect(els.service, uniqSorted(allProjects.map(p => p["Service-Main"])));
        fillSelect(els.category, uniqSorted(allProjects.map(p => p.Category)));

        const years = uniqSorted(allProjects.map(p => p.Year)).sort((a,b)=> yearNum(b) - yearNum(a));
        fillSelect(els.year, years);

        showStartState(true);
        clearResults();

        els.keyword.addEventListener("input", applyFilters);
        els.company.addEventListener("change", applyFilters);
        els.client.addEventListener("change", applyFilters);
        els.region.addEventListener("change", applyFilters);
        els.service.addEventListener("change", applyFilters);
        els.category.addEventListener("change", applyFilters);
        els.year.addEventListener("change", applyFilters);

        els.reset.addEventListener("click", () => {
          els.keyword.value = "";
          els.company.value = "";
          els.client.value = "";
          els.region.value = "";
          els.service.value = "";
          els.category.value = "";
          els.year.value = "";
          applyFilters();
        });

      } catch (e){
        console.error(e);
        showStartState(false);
        els.error.style.display = "block";
      }
    }

    init();
  </script>

  <!-- Projects section switcher (panels only) -->
  <script>
  (function(){
    document.body.setAttribute("data-switcher","on");

    const header = document.querySelector(".nav");
    const aside = document.querySelector("aside");
    const links = aside ? Array.from(aside.querySelectorAll("nav a[href^='#']")) : [];
    if (!links.length) return;

    const main = document.querySelector("main");
    if (!main) return;

    const panels = Array.from(main.querySelectorAll("section[data-panel='1'][id]"));
    if (!panels.length) return;

    const byId = new Map(panels.map(s => [s.id, s]));

    function setActiveLink(id){
      links.forEach(a => a.classList.toggle("is-active", a.getAttribute("href") === "#" + id));
    }

    function showOnly(id){
      const target = byId.get(id) || panels[0];
      if (!target) return;

      panels.forEach(s => s.classList.toggle("is-active", s === target));
      setActiveLink(target.id);

      const offset = (header ? header.getBoundingClientRect().height : 0) + 10;
      const y = target.getBoundingClientRect().top + window.pageYOffset - offset;
      window.scrollTo({ top: y, behavior: "smooth" });
    }

    links.forEach(a => {
      a.addEventListener("click", (e) => {
        e.preventDefault();
        const id = (a.getAttribute("href") || "").slice(1);
        history.replaceState(null, "", "#" + id);
        showOnly(id);
      });
    });

    const hash = (location.hash || "").slice(1);
    const defaultId = (links[0].getAttribute("href") || "").slice(1);
    showOnly(byId.has(hash) ? hash : defaultId);
  })();
  </script>

</body>
</html>
