<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Projects | UNEPP</title>
  <meta name="description" content="UNEPP project portfolio across Egypt, MENA and international markets covering feasibility, FEED, detailed engineering, PMC and procurement." />
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>

<header class="nav">
  <div class="container nav-inner">
    <a class="brand" href="index.html">
      <img src="assets/logo.png" alt="UNEPP logo" class="logo" />
      <div>
        <h1>UNEPP</h1>
        <small>United Engineers for Petroleum Projects</small>
      </div>
    </a>

    <nav class="menu">
      <a href="index.html">Home</a>
      <a href="about.html">About Us</a>
      <a href="capabilities.html">Capabilities</a>
      <a href="projects.html">Projects</a>
      <a href="news.html">News</a>
      <a href="careers.html">Career</a>
      <a class="cta" href="contact.html">Contact Us</a>
    </nav>
  </div>
</header>

<!-- Layout wrapper -->
<main class="container about-layout">

  <!-- LEFT INDEX -->
  <aside class="about-index">
    <b>Projects</b>
    <nav>
      <a href="#portfolio">Projects Portfolio</a>
      <a href="#showcase">Projects Showcase</a>
    </nav>
  </aside>

  <!-- MAIN CONTENT -->
  <div class="about-content">

    <!-- ================================= -->
    <!-- PROJECTS PORTFOLIO SECTION -->
    <!-- ================================= -->
    <section class="section" id="portfolio">

      <div class="section-intro">
        <h2>Projects Portfolio</h2>
        <p class="lead">
          Explore selected UNEPP and UNIFIED references across feasibility, FEED,
          detailed engineering, procurement support, and project delivery.
        </p>
      </div>

      <!-- Filters Card -->
      <div class="card" style="margin-top:14px;">
        <div class="grid" style="grid-template-columns: 1.3fr 1fr 1fr 1fr .7fr; align-items:end;">

          <div style="background:transparent;border:0;padding:0;">
            <label class="kicker">Search</label>
            <input id="q" type="search" placeholder="Search projects, clients..."
              style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text);" />
          </div>

          <div style="background:transparent;border:0;padding:0;">
            <label class="kicker">Client</label>
            <select id="client"></select>
          </div>

          <div style="background:transparent;border:0;padding:0;">
            <label class="kicker">Region</label>
            <select id="region"></select>
          </div>

          <div style="background:transparent;border:0;padding:0;">
            <label class="kicker">Service</label>
            <select id="service"></select>
          </div>

          <div style="background:transparent;border:0;padding:0;">
            <label class="kicker">Year</label>
            <select id="year"></select>
          </div>
        </div>

        <hr class="line" />

        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div class="kicker">
            Showing <span id="count">0</span> projects
          </div>
          <button id="reset" class="btn">➤ Reset Filters</button>
        </div>
      </div>

      <!-- Dynamic Cards -->
      <div id="projectsGrid" class="grid" style="margin-top:18px;"></div>

      <div id="emptyState" class="card" style="display:none;margin-top:14px;">
        <h3>No matches</h3>
        <p class="lead">Try adjusting filters.</p>
      </div>

    </section>

    <!-- ================================= -->
    <!-- PROJECTS SHOWCASE SECTION -->
    <!-- ================================= -->
    <section class="section" id="showcase">

      <div class="section-intro">
        <h2>Projects Showcase</h2>
        <p class="lead">
          A curated selection of flagship projects demonstrating UNEPP’s technical depth,
          execution excellence, and industry leadership. Detailed summaries and project
          overviews will be available here.
        </p>
      </div>

      <div class="card">
        <p class="lead" style="margin:0;">
          Showcase project summaries and case studies will be added in the next development phase.
        </p>
      </div>

    </section>

  </div><!-- about-content -->
</main>

<footer class="footer">
  <div class="container">
    © <span id="y"></span> United Engineers for Petroleum Projects (UNEPP)
  </div>
</footer>

<script>
document.getElementById("y").textContent = new Date().getFullYear();

/* ============================= */
/* Projects JSON Dynamic Script  */
/* ============================= */

const els = {
  q: document.getElementById("q"),
  client: document.getElementById("client"),
  region: document.getElementById("region"),
  service: document.getElementById("service"),
  year: document.getElementById("year"),
  reset: document.getElementById("reset"),
  grid: document.getElementById("projectsGrid"),
  count: document.getElementById("count"),
  empty: document.getElementById("emptyState"),
};

let allProjects = [];

function escapeHtml(str){
  return String(str||"")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;");
}

function fillSelect(el, values){
  el.innerHTML =
    '<option value="">All</option>' +
    values.map(v => `<option value="${v}">${v}</option>`).join("");
}

function applyFilters(){
  const q = els.q.value.toLowerCase();
  const client = els.client.value;
  const region = els.region.value;
  const service = els.service.value;
  const year = els.year.value;

  const filtered = allProjects.filter(p=>{
    if(client && p.Client!==client) return false;
    if(region && p.Region!==region) return false;
    if(service && p.Service!==service) return false;
    if(year && String(p.Year)!==year) return false;

    if(q){
      const text = Object.values(p).join(" ").toLowerCase();
      if(!text.includes(q)) return false;
    }
    return true;
  });

  filtered.sort((a,b)=>(b.Year||0)-(a.Year||0));
  render(filtered);
}

function render(projects){
  els.count.textContent = projects.length;
  els.empty.style.display = projects.length ? "none":"block";

  els.grid.innerHTML = projects.map(p=>`
    <div class="card">
      <h3>${escapeHtml(p.Title)}</h3>
      <p class="lead">${escapeHtml(p.Summary||"")}</p>
      <div class="badges">
        <span class="badge">${p.Client}</span>
        <span class="badge">${p.Region}</span>
        <span class="badge">${p.Service}</span>
        <span class="badge">${p.Year}</span>
      </div>
    </div>
  `).join("");
}

async function init(){
  const res = await fetch("data/projects.json");
  allProjects = await res.json();

  fillSelect(els.client,[...new Set(allProjects.map(p=>p.Client))]);
  fillSelect(els.region,[...new Set(allProjects.map(p=>p.Region))]);
  fillSelect(els.service,[...new Set(allProjects.map(p=>p.Service))]);

  const years=[...new Set(allProjects.map(p=>p.Year))].sort((a,b)=>b-a);
  fillSelect(els.year,years);

  render(allProjects.sort((a,b)=>b.Year-a.Year));

  els.q.oninput = applyFilters;
  els.client.onchange = applyFilters;
  els.region.onchange = applyFilters;
  els.service.onchange = applyFilters;
  els.year.onchange = applyFilters;

  els.reset.onclick = ()=>{
    els.q.value="";
    els.client.value="";
    els.region.value="";
    els.service.value="";
    els.year.value="";
    render(allProjects.sort((a,b)=>b.Year-a.Year));
  };
}

init();
</script>

</body>
</html>
